!function(t,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():t.cpRPA=n()}(this,function(){function t(){this.distance=null,this.center={},this.latlngs=[],this.space=5,this.deg=0}function n(){for(var t=l.latlngs,n=[],r=null,o=0;o<t.length;o++)r=l.transform(t[o].lng,t[o].lat,l.center.lng,l.center.lat,l.deg),n.push({lat:r[1],lng:r[0]});var s=e(n),i=s.nw,h=(s.ne,s.sw);if("function"!=typeof l.distance)throw new Error('You must call the ".setDistanceFn" method and set a function to calculate the distance!');for(var u=l.distance({lat:i.lat,lng:i.lng},{lat:h.lat,lng:h.lng}),c=parseInt(u/l.space/2),p=(i.lat-h.lat)/c,g=[],f=[],m=null,o=0;o<c;o++){f=[];for(var y=0;y<n.length;y++)(m=l.calcPointInLineWithY([n[y].lng,n[y].lat],[n[a(y+1,n.length)].lng,n[a(y+1,n.length)].lat],i.lat-o*p))&&f.push(m);f.length<2||f[0][0]!==f[1][0]&&(o%2?g.push({lat:f[0][1],lng:Math.max(f[0][0],f[1][0])},{lat:f[0][1],lng:Math.min(f[0][0],f[1][0])}):g.push({lat:f[0][1],lng:Math.min(f[0][0],f[1][0])},{lat:f[0][1],lng:Math.max(f[0][0],f[1][0])}))}for(var d=[],o=0;o<g.length;o++)r=l.transform(g[o].lng,g[o].lat,l.center.lng,l.center.lat,-l.deg),d.push({lat:r[1],lng:r[0]});return d}function e(t){for(var n=[],e=[],a=0;a<t.length;a++)n.push(t[a].lat),e.push(t[a].lng);var l=Math.max.apply(null,n),r=Math.max.apply(null,e),o=Math.min.apply(null,n),s=Math.min.apply(null,e);return{nw:{lat:l,lng:s},ne:{lat:l,lng:r},se:{lat:o,lng:r},sw:{lat:o,lng:s},center:{lat:(l+o)/2,lng:(r+s)/2},max:[l,r],min:[o,s]}}function a(t,n){return t>n-1?t-n:t<0?n+t:t}t.prototype.setDistanceFn=function(t){if("function"!=typeof t)throw new Error("setDistanceFn's argument must be a function");this.distance=t},t.prototype.setOptions=function(t){if(!(t.polygon instanceof Array))throw new Error('the "polygon" of options must be a Array like [{lat:Number,lng:Number}]');if("number"!=typeof t.stepRotate)throw new Error('the "stepRotate" of options must be a number!');if("number"!=typeof t.space)throw new Error('the "space" of options must be a number!');return this.latlngs=t.polygon,this.deg=t.stepRotate,this.space=t.space,this.center=e(this.latlngs).center,n()},t.prototype.transform=function(t,n,e,a,l,r,o){var l=l*Math.PI/180;return o||(o=1),r||(r=1),[r*((t-e)*Math.cos(l)-(n-a)*Math.sin(l))+e,o*((t-e)*Math.sin(l)+(n-a)*Math.cos(l))+a]},t.prototype.calcPointInLineWithY=function(t,n,e){var a,l=t[1]-n[1];return!!l&&(!((a=(e-t[1])*(t[0]-n[0])/l+t[0])>t[0]&&a>n[0])&&!(a<t[0]&&a<n[0])&&[a,e])};var l=new t;return l});